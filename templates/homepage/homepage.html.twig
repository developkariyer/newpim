{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block content %}
    <h1>{{ pimcore_input('pageTitle', { 'width': 600, 'placeholder': 'Sayfa Başlığı' }) }}</h1>
    <div class="lead">
        {{ pimcore_wysiwyg('mainContent', { 'height': 300, 'placeholder': 'Ana İçerik' }) }}
    </div>

    <hr> 
    
    <div class="editmode-panel">
        <h3>Öne Çıkan İçerikler</h3>
        
        <div class="editable-selector">
            <label>Öne Çıkan Nesne:</label>
            {{ pimcore_relation("featuredObject", {
                "types": ["object"],
                "subtypes": {
                    "object": ["object"]
                },
                "classes": [],
                "width": 500
            }) }}
        </div>
        
        {% if editmode %}
            <div class="editmode-info">
                <p><i>Düzenleme modundasınız. Yukarıdan bir nesne seçin.</i></p>
            </div>
        {% endif %}
    </div>

    {# Seçilen nesneyi görüntüle #}
    {% if not editmode %}
        {% set featuredObj = pimcore_relation("featuredObject").getElement() %}
        {% if featuredObj %}
            <div class="featured-item">
                <h4>{{ featuredObj.getKey() }}</h4>
                
                {% if featuredObj.getClassName() == "Product" %}
                    <p><strong>Ürün Adı:</strong> {{ featuredObj.getProductName() }}</p>
                    <p><strong>Fiyat:</strong> {{ featuredObj.getPrice() }}</p>
                    {% if featuredObj.getImage() %}
                        <img src="{{ featuredObj.getImage().getThumbnail('content').getPath() }}" alt="{{ featuredObj.getProductName() }}">
                    {% endif %}
                
                {% elseif featuredObj.getClassName() == "User" %}
                    <p><strong>Ad Soyad:</strong> {{ featuredObj.getFirstname() }} {{ featuredObj.getLastname() }}</p>
                    <p><strong>E-posta:</strong> {{ featuredObj.getEmail() }}</p>
                
                {% elseif featuredObj.getClassName() == "Category" %}
                    <p><strong>Kategori Adı:</strong> {{ featuredObj.getName() }}</p>
                    
                {% else %}
                    <p><strong>Nesne ID:</strong> {{ featuredObj.getId() }}</p>
                    <p><strong>Nesne Türü:</strong> {{ featuredObj.getClassName() }}</p>
                {% endif %}
            </div>
        {% else %}
            <p>Henüz bir nesne seçilmemiş.</p>
        {% endif %}
    {% endif %}
    
    <hr>
    
    <div class="editmode-panel">
        <h3>İlişkili Nesneler</h3>
        
        <div class="editable-selector">
            <label>İlişkili Nesneler:</label>
            {{ pimcore_relations("relatedObjects", {
                "types": ["object"],
                "subtypes": {
                    "object": ["object"]
                },
                "classes": [],
                "width": 500,
                "height": 200
            }) }}
        </div>
        
        {% if editmode %}
            <div class="editmode-info">
                <p><i>Düzenleme modundasınız. Yukarıdan ilişkili nesneleri seçin.</i></p>
            </div>
        {% endif %}
    </div>

    {# İlişkili nesneleri görüntüle #}
    {% if not editmode %}
        {% set relatedObjs = pimcore_relations("relatedObjects").getElements() %}
        {% if relatedObjs|length > 0 %}
            <div class="related-items">
                <ul>
                    {% for obj in relatedObjs %}
                        <li>
                            <h5>{{ obj.getKey() }} ({{ obj.getClassName() }})</h5>
                            
                            {% if obj.getClassName() == "Product" %}
                                <p><strong>Ürün Adı:</strong> {{ obj.getProductName() }}</p>
                                <p><strong>Fiyat:</strong> {{ obj.getPrice() }}</p>
                                
                            {% elseif obj.getClassName() == "User" %}
                                <p><strong>Ad Soyad:</strong> {{ obj.getFirstname() }} {{ obj.getLastname() }}</p>
                                
                            {% elseif obj.getClassName() == "Category" %}
                                <p><strong>Kategori Adı:</strong> {{ obj.getName() }}</p>
                                
                            {% else %}
                                <p><strong>Nesne ID:</strong> {{ obj.getId() }}</p>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% else %}
            <p>Henüz ilişkili nesne seçilmemiş.</p>
        {% endif %}
    {% endif %}
{% endblock %}